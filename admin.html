<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>NASCAR Pool Admin</title>

  <style>
    :root{
  --bg:#f6f7f9;
  --card:#111111;
  --text:#000000;
  --muted:rgba(255,255,255,.72);
  --line:rgba(255,255,255,.12);

  --nav:#000000;

  --blue:#007AC2;     /* Lochmara */
  --red:#E4002B;      /* Monza */
  --yellow:#FFD659;   /* Mustard */
  --black:#000000;

  --btn:#007AC2;
  --btn2:#E4002B;
  --danger:#E4002B;

  --shadow: 0 16px 40px rgba(0,0,0,.45);
  --radius:18px;
}

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Helvetica,Arial,sans-serif;
      background: var(--bg);
      color: var(--text);
    }
    .wrap{
      max-width: 820px;
      margin: 0 auto;
      padding: 18px 14px 110px; /* bottom space for nav */
    }
    .title{
      font-size: 34px;
      font-weight: 900;
      letter-spacing: -0.5px;
      margin: 6px 0 10px;
    }
    .pill{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding:10px 12px;
      border-radius: 999px;
      background: rgba(255,214,89,.16);
      border:1px solid var(--yellow);
      color: var(--blue);
      font-weight: 900;
      font-size: 14px;
    }
    .pill small{font-weight:800;color: var(--black)}

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
      margin-top: 14px;
    }
    @media (min-width: 860px){
      .grid.two{grid-template-columns: 1fr 1fr;}
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: var(--shadow);
    }

    .card h3{
      margin:0 0 10px;
      font-size: 18px;
      font-weight: 900;
    }
    .muted{color:var(--muted); font-size: 13px;}
    label{
      display:block;
      font-weight: 800;
      margin: 10px 0 6px;
      font-size: 13px;
      color:#111827;
    }
    input, select, textarea{
      width:100%;
      padding: 12px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      outline:none;
      font-size: 16px;
      background: rgba(0,0,0,.45);
      color: var(--text);
    }
    input::placeholder, textarea::placeholder{color:rgba(255,255,255,.45)}

    textarea{min-height:120px; resize: vertical;}
    .row{display:flex; gap:10px; align-items:center;}
    .row > *{flex:1}
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:100%;
      padding: 13px 14px;
      border-radius: 14px;
      border:none;
      cursor:pointer;
      font-weight: 900;
      font-size: 16px;
      background: var(--btn2); /* red primary */
      color:#fff;
    }
    .btn.secondary{background: var(--btn);}     /* blue */
    .btn.danger{background: var(--danger);}     /* red */
    .btn:disabled{opacity:.55; cursor:not-allowed;}
    .spacer{height:8px}
    .msg{
      margin-top:10px;
      font-size: 13px;
      color: var(--text);
      background: rgba(255,255,255,.06);
      border:1px solid var(--line);
      padding:10px 12px;
      border-radius: 14px;
      white-space: pre-wrap;
    }
    .err{border-color: rgba(228,0,43,.55); background: rgba(228,0,43,.10); }
    .ok{border-color: rgba(255,214,89,.55); background: rgba(255,214,89,.10); }


    /* Bottom Nav */
    .bottomNav{
  position: fixed;
  left:0; right:0; bottom:0;
  padding: 10px 10px calc(10px + env(safe-area-inset-bottom));
  background: rgba(0,0,0,.92);
  backdrop-filter: blur(10px);
  border-top: 1px solid rgba(255,255,255,.10);
}
.navBtn{
  flex:0 0 auto; min-width: 92px;
  background: rgba(255,255,255,.06);
  color:#fff;
  border: 1px solid rgba(255,255,255,.10);
  border-radius: 14px;
  padding: 10px 8px;
  font-weight: 900;
  font-size: 13px;
  cursor:pointer;
  display:flex;
  gap:8px;
  align-items:center;
  justify-content:center;
  text-align:center;
}

.navInner{
  max-width: 820px;
  margin:0 auto;
  display:flex;
  gap:10px;
  justify-content: space-between;
  align-items:center;
  overflow-x:auto;
}
    
.navBtn.active{
  background: rgba(0,122,194,.22);
  border-color: rgba(0,122,194,.55);
}

    .hide{display:none !important;}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="title">NASCAR Pool Admin</div>

    <div class="pill" id="ctxPill">
      Current: <small>(loading‚Ä¶)</small>
    </div>

    <div class="grid two" style="margin-top:12px;">

  <!-- API CONFIG (this is the ONLY thing that gets hidden) -->
  <div id="apiConfigWrap" class="card" style="margin:0;">
    <h3>API Config</h3>
    <div class="muted">Saved locally on this device. If you switch browsers/devices, you‚Äôll re-enter it.</div>

    <!-- Stored summary -->
    <div id="configSummary" class="hide" style="margin-top:10px;">
      <div class="msg ok">
        Configured ‚úÖ
        <div style="margin-top:6px;">
          API Base: <span class="mono" id="apiBaseMasked"></span><br/>
          Admin Key: <span class="mono" id="adminKeyMasked"></span>
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button class="btn secondary" onclick="editConfig()">Edit</button>
        <button class="btn danger" onclick="clearConfig()">Clear</button>
      </div>
    </div>

    <!-- Inputs -->
    <div id="configInputs" style="margin-top:10px;">
      <label>API Base (GAS /exec)</label>
      <input id="apiBase" placeholder="https://script.google.com/macros/s/.../exec" />

      <label>Admin Key</label>
      <input id="adminKey" placeholder="ADMIN_KEY" />

      <div class="spacer"></div>
      <button class="btn secondary" onclick="saveConfig()">Save Config</button>
      <div id="configMsg" class="msg hide"></div>
    </div>
  </div>
</div>


    <!-- Panels (switched by bottom nav) -->
    <div class="grid" style="margin-top:14px;">
      
      <div class="card panel hide" id="panelNumbers">
        <h3>Assign Numbers</h3>
        <div class="muted">Defaults to the current race detected at the top.</div>
       <label>Tournament</label>
       <select id="numTourneySel">
         <option value="1">Tournament 1</option>
         <option value="2">Tournament 2</option>
         <option value="3">Tournament 3</option>
         <option value="4">Tournament 4</option>
         <option value="5">Tournament 5</option>
         <option value="6">Tournament 6</option>
         <option value="7">Tournament 7</option>
         <option value="8">Tournament 8</option>
         <option value="9">Tournament 9</option>
       </select>
       <label>Race</label>
       <select id="numRaceSel">
         <option value="">(loading‚Ä¶)</option>
       </select>
       <div class="spacer"></div>
       <button class="btn" onclick="assignNumbersSelectedFromPanel()">Assign Numbers (Current Race)</button>
       <div class="spacer"></div>
       <button class="btn secondary" onclick="assignNumbersAllFromPanel()">Assign Numbers (ALL 4 Races)</button>
       <div id="numMsg" class="msg hide"></div>
    </div>

      
      <div class="card panel" id="panelAddFunds">
        <h3>Add Funds</h3>
        <label>Player</label>
        <select id="playerSel"><option value="">(loading‚Ä¶)</option></select>

        <label>Amount</label>
        <input id="fundsAmt" placeholder="25 or 25.00" />

        <div class="spacer"></div>
        <button class="btn" onclick="addFunds()">Add Funds</button>

        <div id="fundsMsg" class="msg hide"></div>
      </div>

      <div class="card panel hide" id="panelImport">
        <h3>Paste Starting Lineups / Finishes</h3>
        <div class="muted">Paste the Wikipedia table block. We‚Äôll strip junk like ‚Äú(R)‚Äù and ‚Äú(i)‚Äù and try to match your Drivers tab.</div>

        <label>Which sheet?</label>
        <select id="sheetTypeSel" onchange="loadRaceHeadersForSheet()">
          <option>Starting Lineups</option>
          <option>Finishes</option>
        </select>

        <label>Race Header</label>
        <select id="raceHeaderSel"><option value="">(loading‚Ä¶)</option></select>

        <label>Paste the table block</label>
        <textarea id="rawPaste" placeholder="Paste from Wikipedia (or wherever) here‚Ä¶"></textarea>

        <div class="spacer"></div>
        <button class="btn" onclick="importPaste()">Import Paste</button>

        <div id="importMsg" class="msg hide"></div>
      </div>

      <div class="card panel hide" id="panelRanks">
        <h3>Refresh Overall Rankings</h3>
        <div class="muted">Runs <span class="mono">compileOverallRanks()</span> so the Stats page updates.</div>

        <div class="spacer"></div>
        <button class="btn" onclick="runCompileOverallRanks()">Run CompileOverallRanks</button>

        <div id="ranksMsg" class="msg hide"></div>
      </div>

      <div class="card panel hide" id="panelWinnings">
        <h3>Tournament Winnings</h3>
        <label>Tournament</label>
        <select id="winTourneySel">
          <option value="1">Tournament 1</option><option value="2">Tournament 2</option><option value="3">Tournament 3</option>
          <option value="4">Tournament 4</option><option value="5">Tournament 5</option><option value="6">Tournament 6</option>
          <option value="7">Tournament 7</option><option value="8">Tournament 8</option><option value="9">Tournament 9</option>
        </select>

        <div class="spacer"></div>
        <button class="btn secondary" onclick="showWinnings()">Show Winnings</button>

        <div id="winningsMsg" class="msg hide"></div>
      </div>
    </div>
  </div>

  <!-- Bottom nav -->
  <div class="bottomNav">
    <div class="navInner">
      <button class="navBtn active" id="navNums" onclick="showPanel('Numbers', this)">üé≤<span>Numbers</span></button>
      <button class="navBtn" id="navImport" onclick="showPanel('Import', this)">üìã<span>Paste</span></button>
      <button class="navBtn" id="navRanks" onclick="showPanel('Ranks', this)">üìä<span>Ranks</span></button>
      <button class="navBtn" id="navWin" onclick="showPanel('Winnings', this)">üèÜ<span>Winnings</span></button>
      <button class="navBtn" id="navFunds" onclick="showPanel('AddFunds', this)">üíµ<span>Add</span></button>
      <button class="navBtn" id="navCfg" onclick="toggleConfigCard()">‚öôÔ∏è<span>Config</span></button>
    </div>
  </div>

<script>
  // ---------- Storage ----------
  const LS_API = "nascar_api_base";
  const LS_KEY = "nascar_admin_key";

  function getCfg(){
    return {
      apiBase: (localStorage.getItem(LS_API) || "").trim(),
      adminKey: (localStorage.getItem(LS_KEY) || "").trim(),
    };
  }
  function mask(s){
    if(!s) return "(empty)";
    if(s.length <= 10) return "‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢";
    return s.slice(0, 12) + "‚Ä¶";
  }

  function syncConfigUI(){
    const {apiBase, adminKey} = getCfg();
    const has = !!apiBase && !!adminKey;

    document.getElementById("configSummary").classList.toggle("hide", !has);
    document.getElementById("configInputs").classList.toggle("hide", has);

    if(has){
      document.getElementById("apiBaseMasked").textContent = mask(apiBase);
      document.getElementById("adminKeyMasked").textContent = mask(adminKey);
    }else{
      document.getElementById("apiBase").value = apiBase || "";
      document.getElementById("adminKey").value = adminKey || "";
    }
  }

  function saveConfig(){
    const apiBase = document.getElementById("apiBase").value.trim();
    const adminKey = document.getElementById("adminKey").value.trim();
    const msg = document.getElementById("configMsg");

    if(!apiBase || !apiBase.includes("/exec")){
      showMsg(msg, "Error: API Base must be your GAS Web App URL ending in /exec", true);
      return;
    }
    if(!adminKey){
      showMsg(msg, "Error: Admin Key required.", true);
      return;
    }
    localStorage.setItem(LS_API, apiBase);
    localStorage.setItem(LS_KEY, adminKey);
    showMsg(msg, "Saved. ‚úÖ", false);
    syncConfigUI();
    bootstrap();
    applyConfigVisibility();
  }

  function editConfig(){
    const { apiBase, adminKey } = getCfg();

    // show inputs
    document.getElementById("configSummary").classList.add("hide");
    document.getElementById("configInputs").classList.remove("hide");

    // prefill inputs with what‚Äôs already saved
    document.getElementById("apiBase").value = apiBase || "";
    document.getElementById("adminKey").value = adminKey || "";
  }


  function clearConfig(){
    localStorage.removeItem(LS_API);
    localStorage.removeItem(LS_KEY);
    syncConfigUI();
    document.getElementById("ctxPill").innerHTML = `Current: <small>(not configured)</small>`;
    applyConfigVisibility();
  }

  // ---------- UI helpers ----------
  function showMsg(el, text, isErr){
    el.classList.remove("hide","err","ok");
    el.classList.add(isErr ? "err" : "ok");
    el.textContent = text;
  }
  function hideMsg(el){ el.classList.add("hide"); }

  function escapeHtml(s){
    return String(s ?? "")
      .replace(/&/g,"&amp;")
      .replace(/</g,"&lt;")
      .replace(/>/g,"&gt;")
      .replace(/"/g,"&quot;")
      .replace(/'/g,"&#039;");
  }

  function showPanel(name, btn){
    document.querySelectorAll(".panel").forEach(p => p.classList.add("hide"));
    document.getElementById("panel"+name).classList.remove("hide");

    document.querySelectorAll(".navBtn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
  }

  // ---------- API ----------
  async function apiCall(action, params={}, isAdmin=true){
    const {apiBase, adminKey} = getCfg();
    if(!apiBase) throw new Error("Missing API Base URL.");
    if(isAdmin && !adminKey) throw new Error("Missing Admin Key.");

    const q = new URLSearchParams();
    q.set("action", action);
    if(isAdmin) q.set("key", adminKey);
    Object.keys(params || {}).forEach(k => q.set(k, params[k]));

    const url = apiBase + "?" + q.toString();
    const res = await fetch(url, { cache: "no-store" });
    const json = await res.json();
    return json;
  }

  // ---------- Data loaders ----------
  async function refreshContext(){
    const pill = document.getElementById("ctxPill");
    try{
      pill.innerHTML = `Current: <small>(loading‚Ä¶)</small>`;
      const r = await apiCall("adminGetCurrentContext", {}, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      const c = r.data || {};

      // Save for later (Numbers default)
      window.__ctx = {
        tournament: String(c.tournament || ""),
        round: String(c.round || ""),
        raceLabel: String(c.raceLabel || "")
      };

      pill.innerHTML = `Current: <small>T${c.tournament} ¬∑ Round ${c.round} ¬∑ ${escapeHtml(c.raceLabel || "(no label)")}</small>`;

      // After context loads, sync Numbers panel defaults
      try { await syncNumbersPanelDefaults(); } catch(e) {}

    }catch(e){
      pill.innerHTML = `Current: <small>(could not detect)</small>`;
      window.__ctx = null;
    }
  }


  async function loadPlayers(){
    const sel = document.getElementById("playerSel");
    sel.innerHTML = `<option value="">(loading‚Ä¶)</option>`;
    try{
      const r = await apiCall("playerGetPlayerList", {}, false);
      if(!r.ok) throw new Error(r.error || "API failed");
      const list = r.data || [];
      sel.innerHTML = `<option value="">Select‚Ä¶</option>` + list.map(x => `<option>${escapeHtml(x)}</option>`).join("");
    }catch(e){
      sel.innerHTML = `<option value="">(error)</option>`;
    }
  }

  async function loadRaceHeadersForTournament(){
    const t = document.getElementById("tournamentSel").value;
    const raceSel = document.getElementById("raceSel");
    raceSel.innerHTML = `<option value="">(loading‚Ä¶)</option>`;
    try{
      const r = await apiCall("adminGetTournamentRaceHeaders", { tournament: t }, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      const headers = r.data || [];
      raceSel.innerHTML = headers.length
        ? `<option value="">Select‚Ä¶</option>` + headers.map(h => `<option>${escapeHtml(h)}</option>`).join("")
        : `<option value="">(none)</option>`;
    }catch(e){
      raceSel.innerHTML = `<option value="">(error)</option>`;
    }
  }

  async function loadRaceHeadersForSheet(){
    // For paste importer: we use Starting Lineups / Finishes sheet headers
    const sheetType = document.getElementById("sheetTypeSel").value;
    const sel = document.getElementById("raceHeaderSel");
    sel.innerHTML = `<option value="">(loading‚Ä¶)</option>`;
    try{
      const r = await apiCall("adminGetRaceHeaders", { sheetType }, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      const headers = r.data || [];
      sel.innerHTML = headers.length
        ? `<option value="">Select‚Ä¶</option>` + headers.map(h => `<option>${escapeHtml(h)}</option>`).join("")
        : `<option value="">(none)</option>`;
    }catch(e){
      sel.innerHTML = `<option value="">(error)</option>`;
    }
  }

  async function loadRaceHeadersForTournamentInto(selectEl, tournament){
    selectEl.innerHTML = `<option value="">(loading‚Ä¶)</option>`;
    try{
      const r = await apiCall("adminGetTournamentRaceHeaders", { tournament }, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      const headers = r.data || [];
      selectEl.innerHTML = headers.length
        ? `<option value="">Select‚Ä¶</option>` + headers.map(h => `<option>${escapeHtml(h)}</option>`).join("")
        : `<option value="">(none)</option>`;
      return headers;
    }catch(e){
      selectEl.innerHTML = `<option value="">(error)</option>`;
      return [];
    }
  }

  async function syncNumbersPanelDefaults(){
    const ctx = window.__ctx;
    const tSel = document.getElementById("numTourneySel");
    const rSel = document.getElementById("numRaceSel");
    if(!tSel || !rSel) return;

    // Default tournament to detected one (fallback to 1)
    const t = ctx?.tournament || "1";
    tSel.value = t;

    // Load races for that tournament
    const headers = await loadRaceHeadersForTournamentInto(rSel, t);

    // Default race to detected raceLabel if it exists in the list
    const want = ctx?.raceLabel || "";
    if(want && headers.includes(want)){
      rSel.value = want;
    }
  }

  // ---------- Actions ----------
  async function assignNumbersSelectedFromPanel(){
    const msg = document.getElementById("numMsg");  
    hideMsg(msg);

    const t = document.getElementById("numTourneySel").value;
    const race = document.getElementById("numRaceSel").value;
    if(!race){ showMsg(msg, "Pick a race first.", true); return; }

    try{
      showMsg(msg, "Working‚Ä¶", false);
      const r = await apiCall("adminAssignNumbersForRace", { tournament: t, race }, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      showMsg(msg, r.data?.message || "Done.", false);
      refreshContext();
    }catch(e){
      showMsg(msg, "Error: " + (e.message || e), true);
    }  
  }

  async function assignNumbersAllFromPanel(){
    const msg = document.getElementById("numMsg");
    hideMsg(msg);

    const t = document.getElementById("numTourneySel").value;

    try{
      showMsg(msg, "Working‚Ä¶", false);
      const r = await apiCall("adminAssignNumbersAllRaces", { tournament: t }, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      showMsg(msg, r.data?.message || "Done.", false);
      refreshContext();
    }catch(e){
      showMsg(msg, "Error: " + (e.message || e), true);
    }
  }

  async function addFunds(){
    const msg = document.getElementById("fundsMsg");
    hideMsg(msg);

    const player = document.getElementById("playerSel").value;
    const amt = document.getElementById("fundsAmt").value.trim();
    if(!player){ showMsg(msg, "Pick a player.", true); return; }
    if(!amt){ showMsg(msg, "Enter an amount.", true); return; }

    try{
      showMsg(msg, "Working‚Ä¶", false);
      // You need an admin endpoint for this in api.gs if you don't already have it.
      // If your GAS function is named submitAddFunds(player, amountInput), expose it as adminAddFunds.
      const r = await apiCall("adminAddFunds", { player, amount: amt }, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      showMsg(msg, r.data?.message || "Saved.", false);
    }catch(e){
      showMsg(msg, "Error: " + (e.message || e), true);
    }
  }

  async function importPaste(){
    const msg = document.getElementById("importMsg");
    hideMsg(msg);

    const sheetType = document.getElementById("sheetTypeSel").value;
    const header = document.getElementById("raceHeaderSel").value;
    const rawText = document.getElementById("rawPaste").value;

    if(!header){ showMsg(msg, "Pick a race header.", true); return; }
    if(!rawText.trim()){ showMsg(msg, "Paste the table block first.", true); return; }

    try{
      showMsg(msg, "Importing‚Ä¶", false);
      const r = await apiCall("adminImportPastedList", { sheetType, header, rawText }, true);
      if(!r.ok) throw new Error(r.error || "API failed");

      // AUTO-RUN compileOverallRanks after FINISHES import
      if(String(sheetType).toLowerCase().includes("finish")){
        showMsg(msg, "Imported. Now updating ranks‚Ä¶", false);
        const rr = await apiCall("adminCompileOverallRanks", {}, true);
        if(!rr.ok) throw new Error(rr.error || "Ranks update failed");
        showMsg(msg, "Imported + Ranks updated ‚úÖ", false);
      } else {
        showMsg(msg, `Imported ‚úÖ (${r.data?.rowsWritten || "?"} rows)`, false);
      }

      refreshContext();
    }catch(e){
      showMsg(msg, "Error: " + (e.message || e), true);
    }
  }

  async function runCompileOverallRanks(){
    const msg = document.getElementById("ranksMsg");
    hideMsg(msg);

    try{
      showMsg(msg, "Working‚Ä¶", false);
      const r = await apiCall("adminCompileOverallRanks", {}, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      showMsg(msg, r.data?.message || "Updated ‚úÖ", false);
    }catch(e){
      showMsg(msg, "Error: " + (e.message || e), true);
    }
  }

  async function showWinnings(){
    const msg = document.getElementById("winningsMsg");
    hideMsg(msg);

    const t = document.getElementById("winTourneySel").value;
    try{
      showMsg(msg, "Loading‚Ä¶", false);
      // Expose your existing GAS function buildTournamentWinningsText_ via an admin endpoint if not already.
      const r = await apiCall("adminGetTournamentWinnings", { tournament: t }, true);
      if(!r.ok) throw new Error(r.error || "API failed");
      showMsg(msg, r.data?.text || "(no data)", false);
    }catch(e){
      showMsg(msg, "Error: " + (e.message || e), true);
    }
  }

  // ---------- Bootstrap ----------
  async function bootstrap(){
    const {apiBase, adminKey} = getCfg();
    if(!apiBase || !adminKey) return;

    await refreshContext();
    await loadRaceHeadersForTournament();
    await loadRaceHeadersForSheet();
    await loadPlayers();
  }

  // Tournament change
  document.getElementById("tournamentSel").addEventListener("change", loadRaceHeadersForTournament);
  
  document.getElementById("numTourneySel").addEventListener("change", async () => {
  const t = document.getElementById("numTourneySel").value;
  const rSel = document.getElementById("numRaceSel");
  await loadRaceHeadersForTournamentInto(rSel, t);
  });
  
  // Init
  syncConfigUI();
  bootstrap();

function toggleConfigCard() {
  const wrap = document.getElementById("apiConfigWrap");
  if (!wrap) return;

  wrap.style.display = (wrap.style.display === "none") ? "block" : "none";
}
document.addEventListener("DOMContentLoaded", () => {
  applyConfigVisibility();
});

</script>
</body>
</html>
